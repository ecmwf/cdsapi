[tox]
envlist = qc, py311, py310, py39, py38, py37, pypy3, pypy, deps

[testenv]
setenv = PYTHONPATH = {toxinidir}
deps = -r{toxinidir}/tests/requirements.txt
commands = pytest -v --flakes --cache-clear --basetemp={envtmpdir} {posargs}

[testenv:qc]
# needed for pytest-cov
usedevelop = true
commands = pytest -v --pep8 --mccabe --cov=cdsapi --cov-report=html --cache-clear {posargs}

[testenv:deps]
deps =
commands = pytest

[flake8]
max-line-length = 120
